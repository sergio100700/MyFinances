# ğŸ“Š Sistema de Aportaciones - GuÃ­a Completa

## Â¿QuÃ© es?

El sistema de aportaciones permite registrar **contribuciones periÃ³dicas** a tus inversiones. Esto es especialmente Ãºtil para:

- **DCA (Dollar Cost Averaging)**: Aportaciones regulares a la misma inversiÃ³n
- **Fondos de inversiÃ³n**: MÃºltiples aportes mensuales/semanales
- **Planes de ahorro**: Contribuciones adicionales en diferentes fechas
- **Seguimiento detallado**: Ver exactamente cuÃ¡ndo y cuÃ¡nto has invertido

## ğŸ¯ UbicaciÃ³n

En la pÃ¡gina **ğŸ“ˆ Cartera de Inversiones**, cada inversiÃ³n tiene un botÃ³n **ğŸ“Š** que abre el gestor de aportaciones.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ InversiÃ³n: Apple Inc (US0378331005)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cantidad: 10 | Precio Compra: $150 | Total: ..â”‚
â”‚                                                 â”‚
â”‚ [ğŸ“Š] [âœ Editar] [ğŸ—‘ Eliminar]                  â”‚
â”‚  â†‘                                              â”‚
â”‚  BotÃ³n de Aportaciones                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ CÃ³mo Usar

### Paso 1: Abre el Gestor de Aportaciones

```
Invierte en tu cartera (ğŸ“ˆ)
    â†“
Encuentra tu inversiÃ³n
    â†“
Haz clic en botÃ³n [ğŸ“Š]
```

### Paso 2: Ve el Resumen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Aportaciones - Apple Inc            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚ Total Aportado: $1,500.00              â”‚
â”‚ Valor Actual: $1,850.00                â”‚
â”‚ Ganancia: +$350.00 (+23.33%)           â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Paso 3: Ver Historial

El sistema muestra todas tus aportaciones:

```
ğŸ“ Historial de Aportaciones (3)

Fecha      | Cantidad  | P/Unidad | Monto
-----------|-----------|----------|----------
2026-01-29 | 10.000000 | $150.00  | $1,500.00
2026-01-22 | 5.000000  | $145.00  | $725.00
2026-01-15 | 3.000000  | $140.00  | $420.00
```

### Paso 4: Agregar Nueva AportaciÃ³n

```
1. Haz clic en [â• Agregar Nueva AportaciÃ³n]
2. Rellena el formulario:
   - Fecha
   - Cantidad de Unidades
   - Precio/Unidad
   - Monto Total (se calcula automÃ¡ticamente)
3. Haz clic en [âœ“ Agregar]
```

## ğŸ’¡ Casos de Uso

### Caso 1: DCA Mensual en Fondo

```
Enero:
  â• AportaciÃ³n de $500 a $20/unidad
  â†’ 25 unidades

Febrero:
  â• AportaciÃ³n de $500 a $22/unidad
  â†’ 22.73 unidades

Marzo:
  â• AportaciÃ³n de $500 a $18/unidad
  â†’ 27.78 unidades

Total: $1,500 â†’ 75.51 unidades â†’ Precio promedio: $19.87/unidad
```

### Caso 2: Fondo con Aportaciones Extras

```
AportaciÃ³n Base (Enero): $1,000 a $100/unidad = 10 unidades

Extras:
  - Bono (Marzo): $300 a $105/unidad = 2.86 unidades
  - Ahorro (Mayo): $200 a $110/unidad = 1.82 unidades

Total: $1,500 â†’ 14.68 unidades â†’ Precio promedio: $102.18/unidad
```

### Caso 3: Seguimiento Detallado

```
Quiero saber EXACTAMENTE cuÃ¡ndo invertÃ­ cada peso

Historial completo:
âœ“ InversiÃ³n inicial: 2026-01-01, $5,000
âœ“ ContribuciÃ³n mensual: 2026-02-01, $500
âœ“ ContribuciÃ³n mensual: 2026-03-01, $500
âœ“ ContribuciÃ³n extra: 2026-03-15, $200 (bono)
âœ“ ContribuciÃ³n mensual: 2026-04-01, $500

Total claro: $7,200 invertidos
```

## ğŸ§® CÃ¡lculos AutomÃ¡ticos

### Precio Promedio de Compra

El sistema calcula automÃ¡ticamente tu precio promedio:

```
Formula: Total Invertido / Total Unidades

Ejemplo:
  - AportaciÃ³n 1: 100 unidades a $10 = $1,000
  - AportaciÃ³n 2: 50 unidades a $12 = $600
  - Total: 150 unidades, $1,600 invertidos
  - Precio promedio: $1,600 / 150 = $10.67/unidad
```

### Ganancia/PÃ©rdida

Se calcula basado en todas tus aportaciones:

```
Formula: Valor Actual - Total Invertido

Ejemplo:
  - Total Invertido: $1,600
  - Valor Actual (150 unidades a $11): $1,650
  - Ganancia: $50 (+3.13%)
```

## ğŸ“Š CaracterÃ­sticas

âœ… **Registro AutomÃ¡tico**: Se guarda todo automÃ¡ticamente
âœ… **CÃ¡lculos AutomÃ¡ticos**: Precio promedio actualizado automÃ¡ticamente
âœ… **Historial Completo**: Ver todas las aportaciones en orden
âœ… **EdiciÃ³n Flexible**: Puedes eliminar aportaciones si es necesario
âœ… **Resumen Visual**: Ganancia/pÃ©rdida clara en tiempo real
âœ… **MÃºltiples Divisas**: Soporta todas las divisas disponibles

## âš™ï¸ Funcionalidades Avanzadas

### Editar Aportaciones

```
Si cometiste un error:

1. Ve al Historial
2. Busca la aportaciÃ³n incorrecta
3. Haz clic en [ğŸ—‘ï¸ Eliminar]
4. Agrega una nueva aportaciÃ³n correcta

El precio promedio se recalcula automÃ¡ticamente
```

### Ver Ganancias Realistas

```
Con aportaciones registradas, ves:

Total Aportado: Suma de TODAS las aportaciones
Valor Actual: Precio actual Ã— Total unidades
Ganancia: Diferencia real considerando TODO

Esto es mucho mÃ¡s preciso que solo tener
un "precio de compra promedio" aproximado
```

### Comparar PerÃ­odos

```
Por ejemplo, Â¿cuÃ¡nto ganÃ© en Marzo?

Mira aportaciones de Marzo
Compara con precio actual
Calcula rendimiento del mes
```

## ğŸ¨ Interfaz

### Modal de Aportaciones

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Aportaciones - Fondo XYZ          [âœ•]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚ Total Aportado  â”‚ Valor Actual  â”‚ Ganancia  â”‚
â”‚ $5,000.00       â”‚ $5,500.00     â”‚ +$500.00  â”‚
â”‚                 â”‚               â”‚ (+10.00%) â”‚
â”‚                                              â”‚
â”œâ”€ ğŸ“ Historial de Aportaciones (4)           â”‚
â”‚                                              â”‚
â”‚ [Tabla con todas las aportaciones]           â”‚
â”‚                                              â”‚
â”‚                                              â”‚
â”œâ”€ [â• Agregar Nueva AportaciÃ³n]              â”‚
â”‚                                              â”‚
â”‚ [Cerrar]                                     â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Formulario de Nueva AportaciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â• Nueva AportaciÃ³n                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚ Fecha: [2026-01-29]                         â”‚
â”‚ Cantidad de Unidades: [10.000000]           â”‚
â”‚ Precio/Unidad: [$150.00]                    â”‚
â”‚ Monto Total: [$1,500.00]                    â”‚
â”‚                                              â”‚
â”‚ Monto calculado: $1,500.00                  â”‚
â”‚                                              â”‚
â”‚ [âœ“ Agregar]  [âœ• Cancelar]                  â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Flujo de Datos

### Al Agregar una AportaciÃ³n

```
Usuario ingresa:
â”œâ”€ Fecha
â”œâ”€ Cantidad de unidades
â”œâ”€ Precio por unidad
â””â”€ Monto (opcional, se calcula)
    â†“
Sistema guarda aportaciÃ³n
    â†“
Recalcula totales:
â”œâ”€ Total de unidades
â”œâ”€ Total invertido
â””â”€ Precio promedio
    â†“
Actualiza la inversiÃ³n
    â†“
Recarga cartera
```

### Al Eliminar una AportaciÃ³n

```
Usuario confirma eliminaciÃ³n
    â†“
Se elimina aportaciÃ³n
    â†“
Sistema recalcula:
â”œâ”€ Si quedan aportaciones:
â”‚  â””â”€ Nuevo total (unidades, monto, promedio)
â””â”€ Si no quedan:
   â””â”€ Se limpian contribuciones
    â†“
Actualiza inversiÃ³n
    â†“
Recarga cartera
```

## ğŸ“± Casos de Uso Real

### Usuario: Jorge (DCA en Fondo)

```
Objetivo: Invertir $500 mensuales en fondo de renta fija

Enero 2026: $500 a $100/unidad = 5 unidades
Febrero: $500 a $102/unidad = 4.90 unidades
Marzo: $500 a $98/unidad = 5.10 unidades
Abril: $500 a $101/unidad = 4.95 unidades

âœ“ Con aportaciones:
  - Ve exactamente cuÃ¡ndo invirtiÃ³
  - Ve cuÃ¡ndo fue mejor precio (marzo)
  - Ve promedio ponderado: $100.27/unidad
  - Ve ganancia/pÃ©rdida real

âœ— Sin aportaciones:
  - Solo ve: 20 unidades, $2,000 invertido
  - No sabe el historial
  - Menos informaciÃ³n
```

### Usuario: Maria (Fondo con Aportes Extras)

```
Fondo Mensual:
â”œâ”€ Enero: $1,000
â”œâ”€ Febrero: $1,000
â”œâ”€ Marzo: $1,000
â””â”€ Abril: $1,000

Aportes Extras:
â”œâ”€ Bono Marzo: $500
â””â”€ Aguinaldo: $2,000

âœ“ Con aportaciones:
  - Ve el impacto de cada aporte
  - Sabe cuÃ¡ndo subiÃ³ mÃ¡s por bono
  - Ve ROI por perÃ­odo
  - InformaciÃ³n completa

âœ— Sin aportaciones:
  - Solo: 7 unidades, $6,500
  - Pierde toda la historia
```

## ğŸ¯ Beneficios

| Beneficio | DescripciÃ³n |
|-----------|-------------|
| **PrecisiÃ³n** | Precio promedio exacto basado en todas las aportaciones |
| **Transparencia** | Ve exactamente cuÃ¡ndo y cuÃ¡nto invertiste |
| **Seguimiento** | Monitorea DCA y planes de ahorro |
| **AnÃ¡lisis** | Compara retornos de diferentes perÃ­odos |
| **DocumentaciÃ³n** | Historial completo de inversiones |
| **Impuestos** | Base clara para declaraciÃ³n de impuestos |

## âš ï¸ Consideraciones Importantes

- **Ediciones**: Puedes eliminar aportaciones, pero no editar directamente (elimina y agrega una nueva)
- **Fechas**: Pueden estar en cualquier orden, se muestran ordenadas
- **CÃ¡lculos**: Todo se recalcula automÃ¡ticamente
- **Historial**: Se guarda en localStorage junto con la inversiÃ³n
- **SincronizaciÃ³n**: Si exportas datos, incluye todas las aportaciones

## ğŸš€ Tips de Uso

1. **Agrega regularmente**: No esperes el fin del mes
2. **SÃ© preciso**: Usa fechas reales y montos exactos
3. **Revisa periÃ³dicamente**: Ve cÃ³mo crece tu inversiÃ³n
4. **Aprovecha para anÃ¡lisis**: Ve cuÃ¡ndo fue mejor momento para invertir
5. **Exporta backup**: Las aportaciones se guardan en exportaciones

## ğŸ”— RelaciÃ³n con Otros Sistemas

### Con ImportaciÃ³n/ExportaciÃ³n
```
Exportar: Se guardan todas las aportaciones en el archivo JSON
Importar: Se restauran todas las aportaciones cuando importas
```

### Con EdiciÃ³n de Inversiones
```
Si editas la inversiÃ³n (nombre, ISIN), las aportaciones persisten
Si cambias el modo de valuaciÃ³n, las aportaciones se mantienen
```

### Con ActualizaciÃ³n de Precios
```
Las aportaciones histÃ³ricas no cambian
El precio actual se actualiza automÃ¡ticamente
La ganancia/pÃ©rdida se recalcula siempre
```

## ğŸ“š Archivos Modificados

- `src/types/index.ts` - Agregada interfaz `Contribution`
- `src/components/forms/ContributionManager.tsx` - Nuevo componente
- `src/pages/portfolio.tsx` - Integrado gestor de aportaciones
- `src/lib/storage.ts` - Sin cambios (usa updateInvestment existente)

---

**VersiÃ³n**: 1.0
**Fecha**: 29 de enero de 2026
**Estado**: âœ… Implementado y Funcional
